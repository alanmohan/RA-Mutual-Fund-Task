2026-01-31 18:41:02,139 - __main__ - INFO - Logging initialized. Log file: /Users/alanmohan/Desktop/RA Mutual Fund Task/llm_eval_mutual_funds/logs/experiment_20260131_184102.log
2026-01-31 18:41:02,139 - __main__ - INFO - ======================================================================
2026-01-31 18:41:02,139 - __main__ - INFO - LLM MUTUAL FUND COMPARISON EXPERIMENT
2026-01-31 18:41:02,139 - __main__ - INFO - ======================================================================
2026-01-31 18:41:02,139 - __main__ - INFO - 
1. Loading data...
2026-01-31 18:41:02,237 - __main__ - INFO - 
======================================================================
2026-01-31 18:41:02,237 - __main__ - INFO - 3. RUNNING EXPERIMENTS: meta-llama/Llama-3.2-3B-Instruct on GPU 0
2026-01-31 18:41:02,237 - __main__ - INFO - ======================================================================
2026-01-31 18:41:02,237 - experiment - INFO - Using OpenAI-compatible endpoint for Llama-3.2-3B-Instruct (llama-3.2-3b-instruct)
2026-01-31 18:41:02,237 - experiment - INFO - 
============================================================
2026-01-31 18:41:02,237 - experiment - INFO - Running: Llama-3.2-3B-Instruct - 1_zeroshot_cot_temp0
2026-01-31 18:41:02,237 - experiment - INFO - ============================================================
2026-01-31 18:41:02,237 - experiment - INFO -   Starting from scratch
2026-01-31 18:41:02,237 - experiment - INFO - Building prompts...
2026-01-31 18:41:02,240 - experiment - INFO - Processing samples 0 to 9...
2026-01-31 18:41:03,110 - httpx - INFO - HTTP Request: POST http://127.0.0.1:1234/v1/chat/completions "HTTP/1.1 400 Bad Request"
2026-01-31 18:41:03,115 - __main__ - ERROR - Error running experiments for llama-3.2-3b: Error code: 400 - {'error': 'Invalid JSON Schema: Unrecognized schema: {"better_fund":""}'}
Traceback (most recent call last):
  File "/Users/alanmohan/Desktop/RA Mutual Fund Task/llm_eval_mutual_funds/main.py", line 102, in main
    model_results = run_experiment(model_name, sample_df, device=gpu_id, use_dual_gpu=use_dual_gpu)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alanmohan/Desktop/RA Mutual Fund Task/llm_eval_mutual_funds/experiment.py", line 120, in run_experiment
    batch_responses = run_batch_inference_openai(batch_prompts, cond_config, model_name=OPENAI_MODEL)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alanmohan/Desktop/RA Mutual Fund Task/llm_eval_mutual_funds/inference.py", line 221, in run_batch_inference_openai
    result = client.chat.completions.create(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/myenv/lib/python3.11/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/myenv/lib/python3.11/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/opt/miniconda3/envs/myenv/lib/python3.11/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/myenv/lib/python3.11/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': 'Invalid JSON Schema: Unrecognized schema: {"better_fund":""}'}
